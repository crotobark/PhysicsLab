import type { Mission } from '../../types';

const mission5_1_2: Mission = {
  id: '5-1-2',
  module: 5,
  order: 2,
  title: 'Семейство линейных функций',

  briefing: {
    situation: 'Линейная функция — не одиночка. У неё целая семья! Познакомься с её родственниками: y = kx + b.',
    task: 'Построй несколько линейных функций с разными параметрами k и b. Исследуй, как они влияют на наклон и сдвиг.',
    context: 'k — это наклон (угол), b — это сдвиг вверх/вниз. Меняя их, получаешь бесконечно много прямых!',
  },

  starterCode: `from mathlab import *

# Создаём семейство линейных функций
# y = kx + b, где k — наклон, b — сдвиг

# 1. Базовая функция (k=1, b=0)
f1 = Function("x")

# 2. Добавляем наклон (k=2, b=0)
f2 = Function("___")  # Замени ___ на 2*x

# 3. Добавляем сдвиг (k=1, b=3)
f3 = Function("___")  # Замени ___ на x + 3

# 4. Комбинируем (k=2, b=-2)
f4 = Function("___")  # Замени ___ на 2*x - 2

# Рисуем всю семью
canvas = Canvas(x_range=(-5, 5), y_range=(-10, 10))
canvas.plot(f1, color="blue", name="y = x")
canvas.plot(f2, color="green", name="y = 2x")
canvas.plot(f3, color="orange", name="y = x + 3")
canvas.plot(f4, color="red", name="y = 2x - 2")
canvas.show()

# Проверяем точки пересечения с осью Y
print(f"f1(0) = {f1(0)}")
print(f"f2(0) = {f2(0)}")
print(f"f3(0) = {f3(0)}")
print(f"f4(0) = {f4(0)}")
`,

  theory: [
    '# Семейство линейных функций',
    '',
    'Общий вид линейной функции:',
    '',
    '$$y = kx + b$$',
    '',
    'Где:',
    '- **k** — коэффициент наклона (угол наклона прямой)',
    '- **b** — свободный член (точка пересечения с осью Y)',
    '',
    '## Параметр k (наклон)',
    '',
    '- Если $k > 0$ → функция возрастает (идёт вверх)',
    '- Если $k < 0$ → функция убывает (идёт вниз)',
    '- Если $k = 0$ → горизонтальная прямая',
    '- Чем больше $|k|$, тем круче наклон',
    '',
    '**Примеры:**',
    '- $y = x$ — наклон 45°',
    '- $y = 2x$ — более крутой наклон',
    '- $y = 0.5x$ — более пологий наклон',
    '- $y = -x$ — наклон вниз',
    '',
    '## Параметр b (сдвиг)',
    '',
    '- $b > 0$ → прямая сдвинута вверх',
    '- $b < 0$ → прямая сдвинута вниз',
    '- $b = 0$ → прямая проходит через начало координат',
    '',
    '**Геометрический смысл:**',
    '',
    '$b$ — это значение функции при $x = 0$, т.е. $f(0) = b$',
    '',
    '**Примеры:**',
    '- $y = x + 3$ — прямая сдвинута на 3 вверх',
    '- $y = x - 2$ — прямая сдвинута на 2 вниз',
    '- $y = 2x + 1$ — крутой наклон + сдвиг на 1 вверх',
    '',
    '## Параллельные прямые',
    '',
    'Прямые **параллельны**, если у них одинаковый наклон k:',
    '',
    '- $y = 2x$',
    '- $y = 2x + 3$',
    '- $y = 2x - 5$',
    '',
    'Все эти прямые параллельны, так как $k = 2$ у всех.',
  ],

  checks: [
    {
      type: 'function_expression',
      message_success: '✓ Функция f2 = 2x создана правильно!',
      message_fail: '✗ Проверь f2. Должно быть 2*x (наклон в 2 раза круче)',
      expected_expression: '2*x',
    },
    {
      type: 'function_expression',
      message_success: '✓ Функция f3 = x + 3 создана правильно!',
      message_fail: '✗ Проверь f3. Должно быть x + 3 (сдвиг на 3 вверх)',
      expected_expression: 'x + 3',
    },
    {
      type: 'function_expression',
      message_success: '✓ Функция f4 = 2x - 2 создана правильно!',
      message_fail: '✗ Проверь f4. Должно быть 2*x - 2 (наклон + сдвиг)',
      expected_expression: '2*x - 2',
    },
    {
      type: 'canvas_plot',
      message_success: '✓ Все 4 функции построены на графике!',
      message_fail: '✗ Убедись, что все функции построены с помощью canvas.plot()',
    },
  ],

  hints: [
    {
      level: 1,
      text: 'Подсказка 1: Для f2 нужно увеличить наклон в 2 раза. Это означает умножить x на 2: "2*x"',
    },
    {
      level: 2,
      text: 'Подсказка 2: Для f3 нужно сдвинуть базовую функцию y=x на 3 вверх. Добавь +3: "x + 3"',
    },
    {
      level: 3,
      text: 'Подсказка 3: Полное решение:\nf2 = Function("2*x")\nf3 = Function("x + 3")\nf4 = Function("2*x - 2")\n\nПосле запуска увидишь 4 прямые с разными наклонами и сдвигами!',
    },
  ],

  rewards: {
    xp: 75,
    stars: {
      bronze: 'Познакомился с параметрами k и b',
      silver: 'Построил семейство из 4 функций',
      gold: 'Понял связь между формулой и графиком',
    },
  },

  metadata: {
    difficulty: 'easy',
    estimatedTime: 15,
    prerequisites: ['5-1-1'],
    tags: ['функции', 'линейные функции', 'параметры', 'наклон', 'сдвиг'],
  },
};

export default mission5_1_2;
